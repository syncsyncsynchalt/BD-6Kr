# BD-6Kr

このプロジェクトは、PlayStation Vita用ビデオゲームの戦闘ロジックを、スタンドアロンの.NET アプリケーションとして強引に動作させる試みです。

## ルール

面倒な箇所は戦闘の結果に影響を与えない範囲でオリジナルの実装に手を加える場合があります。

- PS VitaやUnityなしでも動作させる。UnityEngineなどはスタブに置き換える。
- 非同期処理を同期処理に変える場合がある。毎フレームどうこうする訳ではないので。
- スコープをpublicに変える。雑に穿り回したいので。

## 技術仕様

- **ターゲットフレームワーク**: .NET 9.0
- **開発環境**: Visual Studio Code, C# (.NET) devcontainer
- **アーキテクチャ**: x86/x64/ARM64 対応

## 実行方法

```bash
dotnet build BD-6Kr.sln
dotnet build Runner/Runner.csproj
dotnet run --project Runner
```

結果が標準出力に垂れ流されます。

```
【ステップ1】システム/マスターデータ初期化
  システム初期化を開始...
  マスターデータ初期化を開始...
  Mst_DataManagerでマスターデータを読み込み中...
  マスターデータマネージャーを初期化中...
  マスターデータ読み込み完了
  マスターデータマネージャーの初期化完了
  Appクラスでセーブデータを初期化中...
  AppInitializeManagerの初期化完了
  Appクラスでシステムを初期化...
  ManagerBaseで基本マネージャーを初期化...
  システム初期化完了

【ステップ2】提督（プレイヤー）情報の設定
  提督情報の初期化を開始...
  難易度: OTU
  提督名: 新米提督
  初期艦娘: 吹雪 (ID: 9)
  セーブデータを正常に作成しました

【ステップ3】基本的なゲームリソースの設定
  基本的なゲームリソースを設定中...
  基本資源: 燃料1000, 弾薬1000, 鋼材1000, ボーキサイト1000
  高速修復材: 10個, 開発資材: 10個
  初期家具コイン: 5,000
  基本リソース設定完了
  追加の艦娘を配備中...
  追加艦娘: 5隻
    - 大井 (ID: 24)
    - Z3 (ID: 175)
    - 瑞鳳改 (ID: 117)
    - 飛鷹 (ID: 75)
    - 大淀改 (ID: 321)
  基本装備を配備中...
  基本装備: 40個

【ステップ4】艦隊管理システムの初期化

【ステップ5】艦隊編成の準備
  艦隊編成を準備中...
  1番艦隊に艦娘を配備中...
  1番艦隊に6隻の艦娘を配備完了
  艦隊編成準備完了

【ステップ6】出撃準備とマップ選択
  出撃準備を開始中...
  戦略画面（母港）に遷移中...
  マップ選択画面に遷移中...
  出撃可能なマップを確認中...
  南方海域（エリア5）のマップ5-1を選択
  出撃準備完了

【ステップ7】最初の戦闘実行(5-1)
  戦闘を実行中...
  StrategyMapManagerを初期化中...
  エリア5を選択中...
  マップ5-1に出撃中...
  実際のマップID: 51
SortieManager.GoSortie: deck_id=1, map_id=51
SortieMapManager constructor: deck=1, map=1, _req_map=Server_Controllers.Api_req_Map
SortieMapManager._Init(): Map.AreaId=5, Map.No=1, Deck.Id=1
  出撃成功！（エリア5、マップ1）

=== 出撃艦隊の状態 ===
  艦隊規模: 6隻
  1. 吹雪 (Lv.1) HP:15/15 [良好]
  2. 大井 (Lv.1) HP:25/25 [良好]
  3. Z3 (Lv.1) HP:18/18 [良好]
  4. 瑞鳳改 (Lv.1) HP:45/45 [良好]
  5. 飛鷹 (Lv.1) HP:40/40 [良好]
  6. 大淀改 (Lv.1) HP:47/47 [良好]

=== 敵艦隊の情報 ===
  マップ: 5-1 (ショートランド沖)
  敵艦隊規模: 6隻
  1. 軽巡ホ級 HP:53 (火力:42/雷装:72)
  2. 駆逐イ級後期型 HP:35 (火力:38/雷装:60)
  3. 駆逐イ級 HP:20 (火力:5/雷装:15)
  4. 駆逐イ級 HP:20 (火力:5/雷装:15)
  5. 駆逐イ級 HP:20 (火力:5/雷装:15)
  戦闘開始！（陣形: 単縦陣）
  戦闘コマンドを準備中...
  コマンドフェーズモデルを取得しました
  プリセットコマンド数: 3
  プリセットコマンドの内容:
    1番目: Kouku (航空戦)
    2番目: Hougeki (砲撃戦)
    3番目: Raigeki (雷撃戦)
  選択可能なコマンド数: 7
  選択可能なコマンド:
    - Sekkin (接近戦)
    - Hougeki (砲撃戦)
    - Raigeki (雷撃戦)
    - Ridatu (離脱)
    - Taisen (対潜戦)
    - Kaihi (回避)
    - Kouku (航空戦)
  戦闘コマンド実行結果: True
  戦闘コマンド実行完了
  昼戦結果を計算中...
  昼戦完了！
  夜戦突入可能です
  夜戦を開始します...
  夜戦の前処理を実行中...
    夜戦データを取得中...
    艦娘の夜戦開始状態を記録中...
    自軍艦娘の状態を記録中...
      吹雪: HP 6/15 (Tyuuha)
      大井: HP 25/25 (Normal)
      Z3: HP 1/18 (Taiha)
      瑞鳳改: HP 45/45 (Normal)
      飛鷹: HP 1/40 (Taiha)
      大淀改: HP 47/47 (Normal)
    自軍艦娘 6隻の状態を記録しました
    敵軍艦娘の状態を記録中...
    敵軍艦娘 0隻の状態を記録しました
    夜戦用キャッシュデータを更新中...
    夜戦用データを準備中...
    夜戦データを取得しました
    夜戦攻撃データを準備しました（攻撃数: 4）
  夜戦の前処理完了
  夜戦中...
  夜戦結果を取得しました
  夜戦完了！

=== 戦闘結果 ===
  勝利判定: A / MVP: 飛鷹(4)(mstId:75)[1/40 => 1/40(40/40)]番艦
  敵艦:
    1. 軽巡ホ級: 53 → 53 [無傷]
    2. 駆逐イ級後期型: 35 → 3 [大破]
    3. 駆逐イ級: 20 → 0 [撃沈]
    4. 駆逐イ級: 20 → 0 [撃沈]
    5. 駆逐イ級: 20 → 0 [撃沈]
  撃沈数: 3/6隻
  味方艦隊:
    1. 吹雪: 15 → 6 [中破]
    2. 大井: 25 → 25 [無傷]
    3. Z3: 18 → 1 [大破]
    4. 瑞鳳改: 45 → 45 [無傷]
    5. 飛鷹: 40 → 1 [大破]
    6. 大淀改: 47 → 47 [無傷]
  戦闘終了
  5-1戦闘完了！

【ステップ8】5-2への移動準備
  出撃準備を開始中...
  戦略画面（母港）に遷移中...
  マップ選択画面に遷移中...
  出撃可能なマップを確認中...
  南方海域（エリア5）のマップ5-2を選択
  出撃準備完了

【ステップ9】5-2戦闘実行
  戦闘を実行中...
  StrategyMapManagerを初期化中...
  エリア5を選択中...
  マップ5-2に出撃中...
  実際のマップID: 52
SortieManager.GoSortie: deck_id=1, map_id=52
SortieMapManager constructor: deck=1, map=2, _req_map=Server_Controllers.Api_req_Map
SortieMapManager._Init(): Map.AreaId=5, Map.No=2, Deck.Id=1
  出撃成功！（エリア5、マップ2）

=== 出撃艦隊の状態 ===
  艦隊規模: 6隻
  1. 吹雪 (Lv.3) HP:6/15 [中破]
  2. 大井 (Lv.2) HP:25/25 [良好]
  3. Z3 (Lv.2) HP:1/18 [大破]
  4. 瑞鳳改 (Lv.2) HP:45/45 [良好]
  5. 飛鷹 (Lv.3) HP:1/40 [大破]
  6. 大淀改 (Lv.2) HP:47/47 [良好]

=== 敵艦隊の情報 ===
  マップ: 5-2 (南方海域珊瑚諸島沖)
  敵艦隊規模: 6隻
  1. 軽巡ヘ級 HP:57 (火力:48/雷装:80)
  2. 軽巡ホ級 HP:53 (火力:42/雷装:72)
  3. 駆逐イ級後期型 HP:35 (火力:38/雷装:60)
  4. 駆逐イ級後期型 HP:35 (火力:38/雷装:60)
  5. 潜水カ級 HP:27 (火力:0/雷装:64)
  戦闘開始！（陣形: 単縦陣）
  戦闘コマンドを準備中...
  コマンドフェーズモデルを取得しました
  プリセットコマンド数: 3
  プリセットコマンドの内容:
    1番目: Kouku (航空戦)
    2番目: Hougeki (砲撃戦)
    3番目: Raigeki (雷撃戦)
  選択可能なコマンド数: 7
  選択可能なコマンド:
    - Sekkin (接近戦)
    - Hougeki (砲撃戦)
    - Raigeki (雷撃戦)
    - Ridatu (離脱)
    - Taisen (対潜戦)
    - Kaihi (回避)
    - Kouku (航空戦)
  戦闘コマンド実行結果: True
  戦闘コマンド実行完了
  昼戦結果を計算中...
  昼戦完了！
  夜戦突入可能です
  夜戦を開始します...
  夜戦の前処理を実行中...
    夜戦データを取得中...
    艦娘の夜戦開始状態を記録中...
    自軍艦娘の状態を記録中...
      吹雪: HP 6/15 (Tyuuha)
      大井: HP 1/25 (Taiha)
      Z3: HP 0/18 (Gekichin)
      瑞鳳改: HP 1/45 (Taiha)
      飛鷹: HP 0/40 (Gekichin)
      大淀改: HP 1/47 (Taiha)
    自軍艦娘 6隻の状態を記録しました
    敵軍艦娘の状態を記録中...
    敵軍艦娘 0隻の状態を記録しました
    夜戦用キャッシュデータを更新中...
    夜戦用データを準備中...
    夜戦データを取得しました
    夜戦攻撃データを準備しました（攻撃数: 4）
  夜戦の前処理完了
  夜戦中...
  夜戦結果を取得しました
  夜戦完了！

=== 戦闘結果 ===
  勝利判定: D / MVP: 瑞鳳改(3)(mstId:117)[1/45 => 1/45(45/45)]番艦
  敵艦:
    1. 軽巡ヘ級: 57 → 53 [無傷]
    2. 軽巡ホ級: 53 → 41 [無傷]
    3. 駆逐イ級後期型: 35 → 0 [撃沈]
    4. 駆逐イ級後期型: 35 → 0 [撃沈]
    5. 潜水カ級: 27 → 27 [無傷]
  撃沈数: 2/6隻
  味方艦隊:
    1. 吹雪: 6 → 6 [中破]
    2. 大井: 25 → 1 [大破]
    3. Z3: 1 → 0 [撃沈]
    4. 瑞鳳改: 45 → 1 [大破]
    5. 飛鷹: 1 → 0 [撃沈]
    6. 大淀改: 47 → 1 [大破]
  戦闘終了
  5-2戦闘完了！
```